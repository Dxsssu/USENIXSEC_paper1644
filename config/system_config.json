{
  "receiver": {
    "elastic": {
      "host": "10.132.99.60",
      "port": 9200,
      "scheme": "http",
      "index": "alerts-*",
      "sort_field": "@timestamp",
      "batch_size": 200,
      "poll_interval_s": 2.0,
      "start_time": null
    },
    "redis": {
      "url": "redis://localhost:6379/0",
      "queue_key": "socrates:alerts",
      "maxlen": null
    }
  },
  "module1": {
    "queue": {
      "redis_url": "redis://localhost:6379/0",
      "input_key": "socrates:alerts",
      "output_key": "socrates:alerts:aggregated",
      "suppressed_key": "socrates:alerts:suppressed",
      "output_maxlen": null,
      "suppressed_maxlen": null
    },
    "aggregation": {
      "window_s": 300,
      "flush_interval_s": 1.0,
      "pop_timeout_s": 1,
      "max_ref_ids": 200,
      "history_days": 14
    },
    "scoring": {
      "threshold": 50.0,
      "w_freq": 0.35,
      "w_rule": 0.25,
      "w_ctx": 0.2,
      "w_rare": 0.2
    },
    "asset": {
      "table_path": "config/assets_static.json"
    },
    "history": {
      "key_prefix": "socrates:aggr:hist"
    }
  },
  "module2": {
    "queue": {
      "redis_url": "redis://localhost:6379/0",
      "input_key": "socrates:alerts:aggregated",
      "output_key": "socrates:alerts:investigation",
      "suppressed_key": "socrates:alerts:business_suppressed",
      "output_maxlen": null,
      "suppressed_maxlen": null,
      "pop_timeout_s": 1
    },
    "elastic": {
      "enabled": true,
      "host": "10.132.99.60",
      "port": 9200,
      "scheme": "http",
      "index": "alerts-*",
      "request_timeout_s": 5,
      "batch_size": 200
    },
    "model": {
      "model_path": "models/business_self_learning_xgboost.pkl",
      "decision_threshold": 0.72,
      "min_instance_count": 2
    },
    "features": {
      "structural_dim": 32,
      "semantic_dim": 48,
      "temporal_dim": 16,
      "business_hours_start": 8,
      "business_hours_end": 18
    },
    "train": {
      "train_jsonl_path": "data/module2_train.jsonl",
      "train_window_days": 14,
      "test_ratio": 0.2,
      "random_seed": 42,
      "n_estimators": 300,
      "max_depth": 6,
      "learning_rate": 0.05,
      "subsample": 0.85,
      "colsample_bytree": 0.85
    }
  },
  "module3": {
    "queue": {
      "redis_url": "redis://localhost:6379/0",
      "input_key": "socrates:alerts:investigation",
      "output_key": "socrates:alerts:final",
      "manual_review_key": "socrates:alerts:manual_review",
      "output_maxlen": null,
      "manual_review_maxlen": null,
      "pop_timeout_s": 1
    },
    "llm": {
      "model_path": "models/Qwen3-32B",
      "prompts_dir": "prompts/module_context_enhanced_llm",
      "device": "auto",
      "max_new_tokens": 1200,
      "temperature": 0.1,
      "top_p": 0.9
    },
    "elastic": {
      "host": "10.132.99.60",
      "port": 9200,
      "scheme": "http",
      "timeout_s": 10,
      "default_size": 50,
      "index_waf": "waf-*",
      "index_tianyan_alarm": "tianyan-alarm-*",
      "index_zhongzi": "zhongzi-*",
      "index_nginx": "nginx-*",
      "index_huorong": "huorong-*"
    },
    "cmdb": {
      "base_url": "",
      "api_key": "",
      "timeout_s": 8
    },
    "external": {
      "vt_base_url": "https://www.virustotal.com/api/v3",
      "vt_api_key": "",
      "cve_base_url": "https://api.cvesearch.com",
      "cve_api_key": "",
      "timeout_s": 10
    },
    "reasoner": {
      "max_tool_iterations": 8,
      "tool_result_max_items": 30,
      "manual_review_confidence_threshold": 0.55
    }
  }
}
